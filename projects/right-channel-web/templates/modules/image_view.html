<div class="row-fluid">
  <ul class="galery">
    {% set element_in_row = 7 %}
    {% set index = 0 %}
    {% for movie in movies %}
      {% if index % element_in_row == 0 %}
        <li class="first">
      {% elif index % element_in_row == element_in_row - 1 %}
        <li class="last">
      {% else %}
        <li class="middle" style="margin-left: 28px;">
      {% end %}
        <div class="galery-element" style="padding: 4px; position: relative;">
          {% set title =  movie.get('cn_title') or movie.get('en_title') %}
          <div class="galery-element-img">
            <a href="/movie/{{ str(movie['_id']) }}" target="_blank" {% if title %} title="{{ title }}" {% end %}>
              <img src="http://img3.douban.com/mpic/s24524580.jpg">
            </a>
          </div>
          {% if title %}
            <span class="movie-caption" title="{{ title }}">{{ title }}</span>
          {% end %}
          {% if 'douban_rating' in movie %}
            <span class="movie-rating" title="豆瓣评分{{ movie['douban_rating'] }}">{{ movie['douban_rating'] }}</span>
          {% end %}
        </div>
      </li>
      {% set index += 1 %}
    {% end %}
  </ul>
</div>